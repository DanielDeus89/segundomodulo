const lessonTitle = "Lesson 80";
const currentVideoId = "zXHkDGXnvwY";

const timeRanges = [

  { start: 0, end: 28 }, 
  { start: 28, end: 57 }, 
  { start: 57, end: 88 }, 
  { start: 97, end: 119 }, 
  { start: 120, end: 147 }, 
  { start: 147, end: 179 }, 
  { start: 179, end: 322 }, //Practice
  { start: 322, end: 372 }, //Change Into - or +
  { start: 372, end: 495 }, //Practice
  { start: 495, end: 546 }, //Change into interrogative
  { start: 546, end: 672 }, //Practice
  { start: 672, end: 720 }, //Short Answers
  { start: 727, end: 818 }, //"Ask your Friend
  { start: 818, end: 944 }, //"Make Questions
  { start: 944, end: 965 }, //"Conversation in Trio 1
  { start: 964, end: 977 }, //"Conversation in Trio 2
  { start: 977, end: 991 }, //"Conversation in Trio 3
  { start: 991, end: 1032 }, //"Speak Right - Pronunciation
  { start: 1032, end: 1069 }, //"Ask your Friend
  { start: 1032, end: 1069 }, //"Ask your Friend
  { start: 1083, end: 1141 }, //"Ask your Friend
  { start: 1141, end: 1163 }, //"Ask your Friend
  { start: 1163, end: 1180 }, //"Listening 1
  { start: 1180, end: 1191 }, //"Listening 2
  { start: 1191, end: 1202 }, //"Listening 3
  { start: 1202, end: 1211 }, //"Listening 4
  { start: 1211, end: 1220 }, //"Listening 5
  { start: 1220, end: 99999 }, //"Ask your Friend
 
 


];

const lessonCards = [




 {
  "title": "Conversation in Trio",
  "columns": [
    [
      ["Did she save a seat for us?", ""],
      ["Did you save a seat for us?", ""],
      ["Yes, I did. I saved a seat for you.", ""],
      ["Yes, she did. She saved a seat for us.", ""]
    ]
  ]
},
{
  "title": "Conversation in Trio",
  "columns": [
    [
      ["Are these his sunglasses?", ""],
      ["Are these your sunglasses?", ""],
      ["No, they aren't. These are not my sunglasses.", ""],
      ["No, they aren't. These are not his sunglasses.", ""]
    ]
  ]
},
{
  "title": "Conversation in Trio",
  "columns": [
    [
      ["Why did she stop running at the park?", ""],
      ["Why did you stop running at the park?", ""],
      ["I stopped running because now I have to work overtime.", ""],
      ["She had to stop running because now she has to work overtime.", ""]
    ]
  ]
},
{
  "title": "Conversation in Trio",
  "columns": [
    [

    ]
  ]
},
{
  "title": "Conversation in Trio",
  "columns": [
    [

    ]
  ]
},
{
  "title": "Conversation in Trio",
  "columns": [
    [

    ]
  ]
},  
   {
   title: "Practice",
    columns: [
      [ 
      ]
    ]
  },
  {
     title: "Change Into - or +",
    columns: [
      [ 
      ]
    ]
  },
  {
    title: "Practice",
    columns: [
      [ 
      ]
    ]
  },
  {
    title: "Change into interrogative",
    columns: [
      [ 
      ]
    ]
  },
  {
    title: "Practice",
    columns: [
      [
      ]
    ]
  },
  {
    title: "Short Answers",
    columns: [
      [
      ]
    ]
  },
{
  "title": "Ask your Friend",
  "columns": [
    [
      ["If he / she prefers to take a walk or to go swimming.", ""],
      ["If he / she is taking some medicine.", ""],
      ["If he / she knows how many states there are in the United States.", ""],
      ["If he / she knows how many countries there are in South America.", ""],
      ["If he / she does the laundry at his / her house.", ""],
      ["If he / she knows anybody who lives in another country.", ""],
      ["How often he / she accesses his / her Facebook account.", ""],
      ["If he / she usually saves the leftovers.", ""],
      ["How often he / she goes to the movie theater.", ""],
      ["What his / her favorite pizza place is.", ""]
    ]
  ]
},
{
  "title": "Make Questions",
  "columns": [
    [
    ]
  ]
},
{
  "title": "Conversation in Trio",
  "columns": [
    [

    ]
  ]
},
{
  "title": "Conversation in Trio",
  "columns": [
    [

    ]
  ]
},
{
  "title": "Conversation in Trio",
  "columns": [
    [

    ]
  ]
},
{
  "title": "Speak Right - Pronunciation",
  "columns": [
    [
      ["it", "isso / ele / ela (para coisas)"],
      ["live", "viver / morar"],
      ["hit", "bater / atingir"],
      ["sick", "doente"],
      ["ship", "navio"],
      ["sit", "sentar"],
      ["fit", "caber / ajustar / em forma"],
      ["still", "ainda / imÃ³vel / quieto"],
      ["pick", "pegar / escolher"],
      ["lip", "lÃ¡bio"]
    ],
    [
      ["eat", "comer"],
      ["leave", "partir / deixar"],
      ["heat", "calor / aquecer"],
      ["seek", "procurar / buscar"],
      ["sheep", "ovelha"],
      ["seat", "assento / sentar"],
      ["feet", "pÃ©s"],
      ["steal", "roubar"],
      ["peek", "espiar"],
      ["leap", "pular / saltar"]
    ]
  ]
},
{
  "title": "Dialogue & Role Play - Let's Study!",
  "columns": [
    [
      ["Monica:", "", 1036, 1039],
      ["Jennifer:", "", 1039, 1041],
      ["Monica:", "", 1041, 1044],
      ["Jennifer:", "", 1044, 1047],
      ["Monica:", "", 1047, 1049],
      ["Jennifer:", "", 1049, 1052],
      ["Monica:", "", 1051, 1055],
      ["Jennifer:", "", 1055, 1057],
      ["Monica:", "", 1056, 1060],
      ["Jennifer:", "",1059, 1061],
      ["Monica:", "", 1060, 1065],
      ["Jennifer:", "", 1064, 1067],
      ["Monica:", "", 1067, 1069]
    ]
  ]
},
{
  "title": "Dialogue & Role Play - Let's Study!",
  "columns": [
    [
      ["Monica: Jennifer, come to the mall with me.", "", 1036, 1039],
      ["Jennifer: I can't. I have to study.", "", 1039, 1041],
      ["Monica: Come with me now and you can study later.", "", 1041, 1044],
      ["Jennifer: I need to finish my homework for the test tomorrow.", "", 1044, 1047],
      ["Monica: Is there a test tomorrow?", "", 1047, 1049],
      ["Jennifer: Yes, we have an English test tomorrow.", "", 1049, 1052],
      ["Monica: I didn't know we had a test. I should study as well.", "", 1051, 1055],
      ["Jennifer: Would you like to study with me?", "", 1055, 1057],
      ["Monica: I think so. What are you studying now?", "", 1056, 1060],
      ["Jennifer: Spelling.", "",1059, 1061],
      ["Monica: Let me get my books. I will return in an hour. Ok?", "", 1060, 1065],
      ["Jennifer: That sounds good. See you in an hour.", "", 1064, 1067],
      ["Monica: See you in an hour then.", "", 1067, 1069]
    ]
  ]
},
{
  "title": "Listening & Comprehension - Laughter is a Therapy",
  "columns": [
    [
      ["Laughter is a universal _____.", "", 1088, 1092],
      ["It's so contagious that you can be _____ where you don't speak the language,", "", 1092, 1097],
      ["and _____ laughing, probably people around you will start laughing too.", "", 1097, 1103],
      ["_____ you laugh your body produces a substance called â€œendorphinâ€.", "", 1103, 1111],
      ["This substance makes you feel good.", "", 1110, 1114],
      ["_____ in a bad mood, you will automatically feel better.", "", 1114, 1118],
      ["So, laughter is a natural antidepressant.", "", 1118, 1121],
      ["_____ your laughter.", "", 1121, 1123],
      ["Laugh a lot each day. Itâ€™s a great remedy for your health.", "", 1123, 1129],
      ["Laughter _____ you deal with disappointment, frustration or despair.", "", 1129,1135],
      ["Laughter is contagious. Laughter is a therapy.", "", 1135, 1140]
    ]
  ]
},

{
  "title": "Listen and Answer",
  "type": "listening",
  "segments": [
    { "text": " ", "start": 1141, "end": 1145 },  
    { "text": " ", "start": 1145, "end": 1150 },  
    { "text": " ", "start": 1150, "end": 1154 },  
    { "text": " ", "start": 1154, "end": 1157 },  
    { "text": " ", "start": 1157, "end": 1161 }  
  ]
},
{
  "title": "Listening",
  "columns": [
    [
      ["1. ", ""],
      ["a) She forgot to take the kids to school.", ""],
      ["b) She forgot to pay the bill.", ""],
      ["c) She forgot to buy some food.", ""]
    ]
  ]
},
{
  "title": "Listening",
  "columns": [
    [
      ["2. ", ""],
      ["a) They should give a 20% tip.", ""],
      ["b) They should give a 5% tip.", ""],
      ["c) They should give a 10% tip.", ""]
    ]
  ]
},
{
  "title": "Listening",
  "columns": [
    [
      ["3. ", ""],
      ["a) She needs to talk to the marketing department.", ""],
      ["b) She needs to talk to her boss.", ""],
      ["c) She needs to talk to the IT department.", ""]
    ]
  ]
},
{
  "title": "Listening",
  "columns": [
    [
      ["4. ", ""],
      ["a) She wants to buy a new computer.", ""],
      ["b) She wants to change her internet provider.", ""],
      ["c) She wants to sell her laptop.", ""]
    ]
  ]
},
{
  "title": "Listening",
  "columns": [
    [
      ["5. ", ""],
      ["a) He left his wallet at home.", ""],
      ["b) He left his glasses at home.", ""],
      ["c) He left his sunglasses at home.", ""]
    ]
  ]
},
{
  "title": "Listen and Answer",
  "type": "listening",
  "segments": [
    { "text": " ", "start": 1225, "end": 1229 },  
    { "text": " ", "start": 1229, "end": 1233 },  
    { "text": " ", "start": 1233, "end": 1236 },  
    { "text": " ", "start": 1236, "end": 1240 },  
    { "text": " ", "start": 1240, "end": 1245 }  
  ]
}

];

function loadLessonContent() {
  document.getElementById("lessonTitle").textContent = lessonTitle;
  const stack = document.querySelector(".card-stack");
  stack.innerHTML = "";

  lessonCards.forEach((card, index) => {
    const div = document.createElement("div");
    div.className = "card";
    if (index === 0) div.classList.add("active");

    // Verifica se existe imagem no card
if (card.image) {
  const img = document.createElement("img");
  img.src = card.image;
  img.alt = "Imagem da pergunta";
  img.style.maxWidth = "100%";
  img.style.marginBottom = "10px";
  div.appendChild(img);
}


    if (card.title) {
      const h2 = document.createElement("h2");
      h2.className = "section-title";
      h2.textContent = card.title;
      div.appendChild(h2);
    }

    // Cards do tipo Listening
    if (card.type === "listening" && Array.isArray(card.segments)) {
      const row = document.createElement("div");
      row.className = "listening-row";

      card.segments.forEach((segment) => {
        const cardDiv = document.createElement("div");
        cardDiv.className = "listening-card";

        const playBtn = document.createElement("button");
        playBtn.textContent = "â–¶ï¸ Ouvir";
        playBtn.onclick = () => playSegment(segment.start, segment.end);

        const toggleBtn = document.createElement("button");
        toggleBtn.textContent = "ðŸ‘ï¸ Exibir";
        toggleBtn.onclick = function () {
          toggleText(this);
        };

        const span = document.createElement("span");
        span.className = "hidden-text";
        span.textContent = segment.text;

        cardDiv.appendChild(playBtn);
        cardDiv.appendChild(toggleBtn);
        cardDiv.appendChild(span);
        row.appendChild(cardDiv);
      });

      div.appendChild(row);
      stack.appendChild(div);
      return;
    }

    // Outros tipos de cards
    const grid = document.createElement("div");
    grid.className = "grid2";

    card.columns.forEach(colData => {
      const col = document.createElement("div");
      col.className = "vocab-col";

colData.forEach(item => {
  // Verifica se Ã© uma imagem
  if (item[0] === "img" && item[1]) {
    const img = document.createElement("img");
    img.src = item[1];
    img.alt = "Imagem da coluna";
   img.style.display = "block";
img.style.margin = "0 auto 30px";
img.style.maxWidth = "200%";
img.style.maxHeight = "300px";
img.style.borderRadius = "8px";
img.style.boxShadow = "0 2px 6px rgba(0,0,0,0.1)";

    
    col.appendChild(img);
  } else {
    const p = document.createElement("p");

    if (item.length === 4) {
      const [text, , start, end] = item;

      const span = document.createElement("span");
      span.className = "text-blue clickable";
      span.textContent = text;
      span.onclick = () => playSegment(start, end);

      p.appendChild(span);
    } else {
      const [en, pt] = item;
      p.innerHTML = `<span class="text-blue">${en}</span><br><span class="text-white">${pt}</span>`;
    }

    col.appendChild(p);
  }
});


      grid.appendChild(col);
    });

    div.appendChild(grid);
    stack.appendChild(div);
  });
}


function playSegment(start, end) {
  const iframe = document.querySelector("iframe");
  iframe.contentWindow.postMessage(
    JSON.stringify({
      event: "command",
      func: "loadVideoById",
      args: [{
        videoId: currentVideoId,
        startSeconds: start,
        endSeconds: end
      }]
    }),
    "*"
  );
}

function toggleText(button) {
  const card = button.closest(".listening-card");
  const isNowVisible = card.classList.toggle("show-text");
  button.textContent = isNowVisible ? "ðŸ™ˆ Ocultar" : "ðŸ‘ï¸ Exibir";
}



window.onload = () => {
  loadLessonContent();
};
