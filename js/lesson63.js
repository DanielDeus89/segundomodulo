const lessonTitle = "Lesson 63";
const currentVideoId = "6hks9NbKe0s";

const timeRanges = [
  { start: 8, end: 26 },
  { start: 26, end: 95 }, //Vocabulary
  { start: 95, end: 125 }, //Express
  { start: 125, end: 196 }, //Grammar
  { start: 196, end: 244 },
  { start: 244, end: 286 },
  { start: 286, end: 335 },
  { start: 340, end: 498 },
  { start: 506, end: 754 },
  { start: 760, end: 878 },
  { start: 884, end: 1161 },

];

const lessonCards = [
 {
  "title": "Verbs",
  "columns": [
    [["to learn, learned", "aprender"]],
    [["to sing, sang", "cantar"]],
    [["to wait, waited", "esperar"]]
  ]
},
  {
  "title": "Vocabulary",
  "columns": [
    [
      ["song", "canÃ§Ã£o"],
      ["singer", "cantor"],
      ["desk", "carteira escolar, escrivaninha"],
      ["drawer", "gaveta"],
      ["eraser", "borracha, apagador"],
      ["glue", "cola"],
      ["ruler", "rÃ©gua"],
      ["pencil", "lÃ¡pis"],
      ["pencil holder", "estojo de lÃ¡pis"],
      ["pencil case", "estojo de lÃ¡pis"]
    ],
    [
      ["mechanical pencil", "lapiseira"],
      ["lead pencil", "lapiseira"],
      ["pencil sharpener", "apontador de lÃ¡pis"],
      ["under", "embaixo, sob"],
      ["bill", "conta, nota (de dinheiro)"],
      ["receipt", "recibo"],
      ["cafeteria", "refeitÃ³rio"],
      ["cafÃ©", "lanchonete"],
      ["account", "conta"],
      ["choir", "coral"]
    ]
  ]
},
{
  "title": "Expressions",
  "columns": [
    [
      ["broke", "liso, sem dinheiro"],
      ["in front of", "em frente de"],
      ["behind", "atrÃ¡s de"],
      ["Have a nice day", "Tenha um bom dia"]
    ],
    [
      ["every other day", "dia sim, dia nÃ£o"],
      ["to check the email", "ver o email"],
      ["Christmas carol", "canÃ§Ã£o de natal"]
    ]
  ]
},


 {
  "title": "Grammar",
  "columns": [
    [
      ["How old are you?", "Quantos anos vocÃª tem?"],
      ["I'm twenty-five years old.", "Tenho vinte e cinco anos."],
      ["How old is she?", "Quantos anos ela tem?"],
      ["She's fifteen.", "Ela tem quinze."],

            ["",""],

      ["Years",""],

      ["1956", "nineteen fifty-six"],
      ["1990", "nineteen ninety"],
      ["1821", "eighteen twenty-one"]
    ],
    [
      ["How old is he?", "Quantos anos ele tem?"],
      ["He's thirty years old.", "Ele tem trinta anos."],
      ["The school is in front of the store.", "A escola Ã© em frente da loja."],
      ["His room is behind the cafeteria.", "Sua sala Ã© atrÃ¡s do refeitÃ³rio."],
       ["",""],
        ["",""],
              ["2000", "two thousand"],
      ["1901", "nineteen oh one"],
      ["2010", "two thousand ten"]
    ]
  ]
},
{
  "title": "Phrases",
  "columns": [
    [
      ["When did you learn how to drive?", ""],
      ["She learned how to cook very well.", ""],
      ["Did he learn how to speak Chinese?", ""],
      ["Are they learning Japanese?", ""],
      ["They sang Christmas carols at school.", ""],
      ["Did anybody sing at the party?", ""],
      ["What song are they singing?", ""],
      ["He didn't sing in the choir.", ""]
    ]
  ]
},
{
  "title": "Phrases",
  "columns": [
   [
      ["They had to wait for three hours.", ""],
      ["We didn't wait for them.", ""],
      ["Did he wait for you?", ""],
      ["Who's waiting for us?", ""],
            ["How old are you?", ""],
      ["I'm thirty-two years old.", ""],
      ["How old is he?", ""],
      ["He's eighteen years old.", ""]
    ]   ]
  
},
{
  "title": "Phrases",
  "columns": [
    [
      ["I started working in 2005.", ""],
      ["I started studying in 2009.", ""],
      ["They went to China in 2006.", ""],
      ["She opened the store in 1998.", ""],
            ["The hospital is behind the mall.", ""],
      ["They are waiting for us in front of the store.", ""],
      ["Are you in front of the cafeteria?", ""],
      ["She is behind him.", ""]
    ]  


  ]
},
 {
  "title": "Verbs",
  "columns": [
    [["to learn, learned", "aprender"]],
    [["to sing, sang", "cantar"]],
    [["to wait, waited", "esperar"]]
  ]
},
  {
  "title": "Vocabulary",
  "columns": [
    [
      ["song", "canÃ§Ã£o"],
      ["singer", "cantor"],
      ["desk", "carteira escolar, escrivaninha"],
      ["drawer", "gaveta"],
      ["eraser", "borracha, apagador"],
      ["glue", "cola"],
      ["ruler", "rÃ©gua"],
      ["pencil", "lÃ¡pis"],
      ["pencil holder", "estojo de lÃ¡pis"],
      ["pencil case", "estojo de lÃ¡pis"]
    ],
    [
      ["mechanical pencil", "lapiseira"],
      ["lead pencil", "lapiseira"],
      ["pencil sharpener", "apontador de lÃ¡pis"],
      ["under", "embaixo, sob"],
      ["bill", "conta, nota (de dinheiro)"],
      ["receipt", "recibo"],
      ["cafeteria", "refeitÃ³rio"],
      ["cafÃ©", "lanchonete"],
      ["account", "conta"],
      ["choir", "coral"]
    ]
  ]
},
{
  "title": "Expressions",
  "columns": [
    [
      ["broke", "liso, sem dinheiro"],
      ["in front of", "em frente de"],
      ["behind", "atrÃ¡s de"],
      ["Have a nice day", "Tenha um bom dia"]
    ],
    [
      ["every other day", "dia sim, dia nÃ£o"],
      ["to check the email", "ver o email"],
      ["Christmas carol", "canÃ§Ã£o de natal"]
    ]
  ]
},
 
 {
  "title": "Grammar",
  "columns": [
    [
      ["How old are you?", "Quantos anos vocÃª tem?"],
      ["I'm twenty-five years old.", "Tenho vinte e cinco anos."],
      ["How old is she?", "Quantos anos ela tem?"],
      ["She's fifteen.", "Ela tem quinze."],

            ["",""],

      ["Years",""],

      ["1956", "nineteen fifty-six"],
      ["1990", "nineteen ninety"],
      ["1821", "eighteen twenty-one"]
    ],
    [
      ["How old is he?", "Quantos anos ele tem?"],
      ["He's thirty years old.", "Ele tem trinta anos."],
      ["The school is in front of the store.", "A escola Ã© em frente da loja."],
      ["His room is behind the cafeteria.", "Sua sala Ã© atrÃ¡s do refeitÃ³rio."],
       ["",""],
        ["",""],
              ["2000", "two thousand"],
      ["1901", "nineteen oh one"],
      ["2010", "two thousand ten"]
    ]
  ]
}


  
];





function loadLessonContent() {
  document.getElementById("lessonTitle").textContent = lessonTitle;
  const stack = document.querySelector(".card-stack");
  stack.innerHTML = "";

  lessonCards.forEach((card, index) => {
    const div = document.createElement("div");
    div.className = "card";
    if (index === 0) div.classList.add("active");

    // TÃ­tulo
    if (card.title) {
      const h2 = document.createElement("h2");
      h2.className = "section-title";
      h2.textContent = card.title;
      div.appendChild(h2);
    }

    // Se for card de Listening
    if (card.type === "listening" && Array.isArray(card.segments)) {
      const row = document.createElement("div");
      row.className = "listening-row";

      card.segments.forEach((segment) => {
        const cardDiv = document.createElement("div");
        cardDiv.className = "listening-card";

        const playBtn = document.createElement("button");
        playBtn.textContent = "â–¶ï¸ Ouvir";
        playBtn.onclick = () => playSegment(segment.start, segment.end);

        const toggleBtn = document.createElement("button");
        toggleBtn.textContent = "ğŸ‘ï¸ Exibir";
        toggleBtn.onclick = function () {
          toggleText(this);
        };

        const span = document.createElement("span");
        span.className = "hidden-text";
        span.textContent = segment.text;

        cardDiv.appendChild(playBtn);
        cardDiv.appendChild(toggleBtn);
        cardDiv.appendChild(span);
        row.appendChild(cardDiv);
      });

      div.appendChild(row);
      stack.appendChild(div);
      return; // evita processar abaixo
    }

    // Cards normais
    const grid = document.createElement("div");
    grid.className = "grid2";

    card.columns.forEach(colData => {
      const col = document.createElement("div");
      col.className = "vocab-col";

      colData.forEach(([en, pt]) => {
        const p = document.createElement("p");
        p.innerHTML = `<span class="text-blue">${en}</span><br><span class="text-white">${pt}</span>`;
        col.appendChild(p);
      });

      grid.appendChild(col);
    });

    div.appendChild(grid);
    stack.appendChild(div);
  });
}

// ğŸ”¸ ESSENCIAL PARA FUNCIONAR:
window.onload = () => {
  loadLessonContent();
};

function toggleText(button) {
  const card = button.closest(".listening-card");
  const isNowVisible = card.classList.toggle("show-text");
  button.textContent = isNowVisible ? "ğŸ™ˆ Ocultar" : "ğŸ‘ï¸ Exibir";
}
