const lessonTitle = "Lesson 72";
const currentVideoId = "RV21JB75qS4";

const timeRanges = [
  { start: 4, end: 999 }, 
  { start: 60, end: 999 }, 
  { start: 92, end: 110 }, // 
  { start: 110, end: 125 }, //https://youtu.be/RV21JB75qS4?t=124
  { start: 125, end: 143 }, //https://youtu.be/RV21JB75qS4?t=143
  { start: 143, end: 157 }, //https://youtu.be/RV21JB75qS4?t=157
  { start: 157, end: 172 }, //https://youtu.be/RV21JB75qS4?t=172
  { start: 172, end: 187 }, //
  { start: 187, end: 211 }, // https://youtu.be/RV21JB75qS4?t=194
  { start: 220, end: 249 }, //https://youtu.be/RV21JB75qS4?t=249
  { start: 249, end: 273 }, //https://youtu.be/RV21JB75qS4?t=273
  { start: 273, end: 305 }, //https://youtu.be/RV21JB75qS4?t=305
  { start: 220, end: 249 }, //https://youtu.be/RV21JB75qS4?t=249
  { start: 249, end: 273 }, //https://youtu.be/RV21JB75qS4?t=273
  { start: 273, end: 305 }, //https://youtu.be/RV21JB75qS4?t=305
  { start: 400, end: 523 }, //https://youtu.be/RV21JB75qS4?t=405
  { start: 523, end: 575 }, //https://youtu.be/RV21JB75qS4?t=575
  { start: 575, end: 697 }, //https://youtu.be/RV21JB75qS4?t=697
  { start: 697, end: 751 }, //https://youtu.be/RV21JB75qS4?t=751
  { start: 751, end: 884 }, //https://youtu.be/RV21JB75qS4?t=884
  { start: 884, end: 937 }, //https://youtu.be/RV21JB75qS4?t=937
  { start: 946, end: 1028 }, //https://youtu.be/RV21JB75qS4?t=1027
  { start: 1039, end: 1145 }, //https://youtu.be/RV21JB75qS4?t=1145
  { start: 1155, end: 1219 }, //https://youtu.be/RV21JB75qS4?t=1219
  { start: 1228, end: 99999 }, //https://youtu.be/RV21JB75qS4?t=1228
 
 
];

const lessonCards = [

{
  "title": "A Goal or a Wish?",
  "columns": [
    [
      ["If _____ stop _____ street _____ ask:", "", 4, 9],
      ["'What _____ you _____ be _____ one year _____?'", "", 9, 12],
      ["_____ do _____ want _____ be _____ from _____?", "", 12, 15],
      ["'What _____ your plans _____?'", "", 15, 19],
      ["Very _____ people _____ have _____ answer _____ you.", "", 19, 22],
      ["If you _____ you're _____, how will you _____ when you'll _____?", "", 22, 27],
      ["This means that _____ to determine in advance where you want to be so that _____ proper plans to arrive there.", "", 27, 36],
      ["Your goals should not be so easy that you can reach _____ without effort.", "", 36, 42],
      ["But they _____ too difficult, so that you end up frustrating _____.", "", 41, 46],
      ["You must have a long-range goal and then divide this goal into smaller goals.", "", 46, 52],
      ["Finally, remember _____ goals. A goal not written is only a wish.", "", 52, 60]
    ]
  ]
},

{
  "title": "Discussion - Goals",
  "type": "listening",
  "segments": [
    { "text": "1. If you ask people on the street about their goals, what answer will you get?", "start": 60, "end": 67 }, //https://youtu.be/RV21JB75qS4?t=67
    { "text": "2. If people don't know where they are going, how will they know when they arrive there?", "start": 67, "end": 75 }, 
    { "text": "3. Why do people need to determine in advance where they want to be?", "start": 75, "end": 82 }, 
    { "text": "4. Should goals be easy or difficult?", "start": 82, "end": 86 }, 
    { "text": "5. A goal not written is just a...", "start": 86, "end": 90 }
  ]
},
{
  title: "Listening - Question 1",
  columns: [
    [
    ["img", "../images/72_1.png"],
    ["a)", "", 4, 17],
    ["b)", "", 4, 17],
    ["c)", "", 4, 17]
    ]
  ]
},
{
  title: "Listening - Question 2",
  columns: [
    [
      ["img", "../images/72_2.png"],
      ["a)", "", 18, 33],
      ["b)", "", 4, 17],
      ["c)", "", 4, 17]
    ]
  ]
},
{
  title: "Listening - Question 3",
  columns: [
    [
      ["img", "../images/72_3.png"],
      ["a)", "", 33, 17],
      ["b)", "", 4, 17],
      ["c)", "", 4, 17]
    ]
  ]
},
{
  title: "Listening - Question 4",
  columns: [
    [
      ["img", "../images/72_4.png"],
      ["a)", "", 33, 17],
      ["b)", "", 4, 17],
      ["c)", "", 4, 17]
    ]
  ]
},
{
  title: "Listening - Question 5",
columns: [
  [
    ["img", "../images/72_5.png"],
    ["a)", "", 33, 17],
    ["b)", "", 4, 17],
    ["c)", "", 4, 17]
  ]
]
},
{
  title: "Listening - Question 6",
  columns: [
    [
      ["img", "../images/72_6.png"],
      ["a)", "", 33, 17],
      ["b)", "", 4, 17],
      ["c)", "", 4, 17]
    ]
  ]
},
{
  "title": "Listen and Answer",
  "type": "listening",
  "segments": [
    { "text": "1. How is the weather today?", "start": 187, "end": 195 }, // https://youtu.be/RV21JB75qS4?t=194
    { "text": "2. What time do you usually leave home in the morning?", "start": 194, "end": 198 }, // https://youtu.be/RV21JB75qS4?t=198
    { "text": "3. Do you like to go camping?", "start": 198, "end": 201 }, // https://youtu.be/RV21JB75qS4?t=200
    { "text": "4. Do you remember how much your electricity bill was last month?", "start": 201, "end": 206 }, // https://youtu.be/RV21JB75qS4?t=205
    { "text": "5. What do you like to do on weekends?", "start": 206, "end": 211 } // https://youtu.be/RV21JB75qS4?t=209
  ]
},
{
  "title": "Conversation in Trio",
  "columns": [
    [
      ["When is her birthday?", ""],
      ["When is your birthday?", ""],
      ["My birthday is on May 22<sup>nd</sup>.", ""],
      ["Her birthday is on May 22<sup>nd</sup>.", ""]
    ]
  ]
},
{
  "title": "Conversation in Trio",
  "columns": [
    [
      ["Can he drive?", ""],
      ["Can you drive?", ""],
      ["Yes, I can. I can drive.", ""],
      ["Yes, he can. He can drive.", ""]
    ]
  ]
},
{
  "title": "Conversation in Trio",
  "columns": [
    [
      ["When is she going to travel to Europe?", ""],
      ["When are you going to travel to Europe?", ""],
      ["I'm going to travel to Europe in December.", ""],
      ["She's going to travel to Europe in December.", ""]
    ]
  ]
},
{
  "title": "Conversation in Trio",
  "columns": [
    [
    ]
  ]
}, 
{
  "title": "Conversation in Trio",
  "columns": [
    [
    ]
  ]
}, 
{
  "title": "Conversation in Trio",
  "columns": [
    [
    ]
  ]
},
   
  {
   title: "Practice",
    columns: [
      [ 
      ]
    ]
  },
  {
     title: "Change Into - or +",
    columns: [
      [ 
      ]
    ]
  },
  {
    title: "Practice",
    columns: [
      [ 
      ]
    ]
  },
  {
    title: "Change into interrogative",
    columns: [
      [ 
      ]
    ]
  },
  {
    title: "Practice",
    columns: [
      [
      ]
    ]
  },
  {
    title: "Short Answers",
    columns: [
      [
      ]
    ]
  },
  {
  "title": "Ask your Friend",
  "columns": [
    [
      ["When his/her birthday is.", ""],
      ["If he/she was stubborn when he/she was little.", ""],
      ["If he/she thinks Math is boring.", ""],
      ["If he/she knows how to drive.", ""],
      ["If he/she already has a driver's license.", ""],
      ["If he/she is a patient or impatient person.", ""],
      ["If he/she arrives early or late for his/her appointments.", ""],
      ["How often he/she uses the computer.", ""],
      ["If he/she forgets things easily.", ""],
      ["What website he/she visits every day.", ""]
    ]
  ]
},
  {
    title: "Ask your Friend",
    columns: [
      [ 
      ]
    ]
  },
{
  "title": "Speak Right - Pronunciation",
  "columns": [
    [
      ["it", "isso / ele / ela (para coisas)"],
      ["is", "é / está"],
      ["in", "em / dentro"],
      ["pin", "alfinete / prender com alfinete"],
      ["lip", "lábio"],
      ["kid", "criança / garoto"],
      ["sick", "doente"],
      ["tip", "dica / gorjeta / ponta"],
      ["fix", "consertar / corrigir"],
      ["mix", "misturar"]
    ],
    [
      ["list", "lista"],
      ["fit", "em forma / caber / ajustar"],
      ["kiss", "beijo / beijar"],
      ["miss", "sentir falta / errar / senhorita"],
      ["wish", "desejar / desejo"],
      ["fish", "peixe / pescar"],
      ["trick", "truque / enganar"],
      ["trip", "viagem / tropeçar"],
      ["thin", "magro / fino"],
      ["did", "fez (passado de do)"]
    ]
  ]
},
{
  "title": "Dialogue & Role Play - Making Plans",
  "columns": [
    [
      ["Ryan: Hi Jake, what are you going to do tonight?", "", 1228, 1233], //https://youtu.be/RV21JB75qS4?t=1233
      ["Jake: Hi Ryan, I think I'm going to watch a movie tonight.", "", 1233, 1237],
      ["Ryan: Really? Which movie are you going to watch?", "", 1236, 1239],
      ["Jake: An adventure movie. How about you? What are you doing tonight?", "", 1239, 1243],
      ["Ryan: I'm going to Eric's house. He's going to study in Italy for a year, so I'd like to go to his house and say goodbye.", "", 1243, 1250],
      ["Jake: Who is going to be there?", "", 1250, 1252],
      ["Ryan: I think his family and close friends are going to be there.", "", 1252, 1255],
      ["Jake: Oh nice, I'm sure he's going to miss his family and friends.", "", 1255, 1259],
      ["Ryan: Yeah, but this experience is going to be great for his career.", "", 1259, 1263],
      ["Jake: Well, I have to go now. See you soon.", "", 1263, 1266],
      ["Ryan: See you and have fun with your movie.", "", 1266, 1268]
    ]
  ]
}


];

function loadLessonContent() {
  document.getElementById("lessonTitle").textContent = lessonTitle;
  const stack = document.querySelector(".card-stack");
  stack.innerHTML = "";

  lessonCards.forEach((card, index) => {
    const div = document.createElement("div");
    div.className = "card";
    if (index === 0) div.classList.add("active");

    // Verifica se existe imagem no card
if (card.image) {
  const img = document.createElement("img");
  img.src = card.image;
  img.alt = "Imagem da pergunta";
  img.style.maxWidth = "100%";
  img.style.marginBottom = "10px";
  div.appendChild(img);
}


    if (card.title) {
      const h2 = document.createElement("h2");
      h2.className = "section-title";
      h2.textContent = card.title;
      div.appendChild(h2);
    }

    // Cards do tipo Listening
    if (card.type === "listening" && Array.isArray(card.segments)) {
      const row = document.createElement("div");
      row.className = "listening-row";

      card.segments.forEach((segment) => {
        const cardDiv = document.createElement("div");
        cardDiv.className = "listening-card";

        const playBtn = document.createElement("button");
        playBtn.textContent = "▶️ Ouvir";
        playBtn.onclick = () => playSegment(segment.start, segment.end);

        const toggleBtn = document.createElement("button");
        toggleBtn.textContent = "👁️ Exibir";
        toggleBtn.onclick = function () {
          toggleText(this);
        };

        const span = document.createElement("span");
        span.className = "hidden-text";
        span.textContent = segment.text;

        cardDiv.appendChild(playBtn);
        cardDiv.appendChild(toggleBtn);
        cardDiv.appendChild(span);
        row.appendChild(cardDiv);
      });

      div.appendChild(row);
      stack.appendChild(div);
      return;
    }

    // Outros tipos de cards
    const grid = document.createElement("div");
    grid.className = "grid2";

    card.columns.forEach(colData => {
      const col = document.createElement("div");
      col.className = "vocab-col";

colData.forEach(item => {
  // Verifica se é uma imagem
  if (item[0] === "img" && item[1]) {
    const img = document.createElement("img");
    img.src = item[1];
    img.alt = "Imagem da coluna";
   img.style.display = "block";
img.style.margin = "0 auto 30px";
img.style.maxWidth = "200%";
img.style.maxHeight = "300px";
img.style.borderRadius = "8px";
img.style.boxShadow = "0 2px 6px rgba(0,0,0,0.1)";

    
    col.appendChild(img);
  } else {
    const p = document.createElement("p");

    if (item.length === 4) {
      const [text, , start, end] = item;

      const span = document.createElement("span");
      span.className = "text-blue clickable";
      span.textContent = text;
      span.onclick = () => playSegment(start, end);

      p.appendChild(span);
    } else {
      const [en, pt] = item;
      p.innerHTML = `<span class="text-blue">${en}</span><br><span class="text-white">${pt}</span>`;
    }

    col.appendChild(p);
  }
});


      grid.appendChild(col);
    });

    div.appendChild(grid);
    stack.appendChild(div);
  });
}


function playSegment(start, end) {
  const iframe = document.querySelector("iframe");
  iframe.contentWindow.postMessage(
    JSON.stringify({
      event: "command",
      func: "loadVideoById",
      args: [{
        videoId: currentVideoId,
        startSeconds: start,
        endSeconds: end
      }]
    }),
    "*"
  );
}

function toggleText(button) {
  const card = button.closest(".listening-card");
  const isNowVisible = card.classList.toggle("show-text");
  button.textContent = isNowVisible ? "🙈 Ocultar" : "👁️ Exibir";
}



window.onload = () => {
  loadLessonContent();
};
